Status: 201
Response: [{"schemaname":"public","tablename":"tickets","policyname":"Admin All Access","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"ALL","qual":"(workspace_id IN ( SELECT workspaces.id\n   FROM workspaces\n  WHERE (workspaces.owner_id = auth.uid())))","with_check":"(workspace_id IN ( SELECT workspaces.id\n   FROM workspaces\n  WHERE (workspaces.owner_id = auth.uid())))"},{"schemaname":"public","tablename":"profiles","policyname":"Users can view own profile","permissive":"PERMISSIVE","roles":"{public}","cmd":"SELECT","qual":"(auth.uid() = id)","with_check":null},{"schemaname":"public","tablename":"profiles","policyname":"Users can insert own profile","permissive":"PERMISSIVE","roles":"{public}","cmd":"INSERT","qual":null,"with_check":"(auth.uid() = id)"},{"schemaname":"storage","tablename":"objects","policyname":"Admin Storage Update","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"UPDATE","qual":"(EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE (((w.id)::text = (storage.foldername(w.name))[1]) AND (w.owner_id = auth.uid()))))","with_check":"(EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE (((w.id)::text = (storage.foldername(w.name))[1]) AND (w.owner_id = auth.uid()))))"},{"schemaname":"storage","tablename":"objects","policyname":"Admin Storage Delete","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"DELETE","qual":"(EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE (((w.id)::text = (storage.foldername(w.name))[1]) AND (w.owner_id = auth.uid()))))","with_check":null},{"schemaname":"public","tablename":"tickets","policyname":"Tickets Access Policy","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = tickets.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"employees","policyname":"Employees Access Policy","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"SELECT","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = employees.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"outsourced_companies","policyname":"Secure Access Outsourced","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = outsourced_companies.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"checklist_templates","policyname":"Secure Access Templates","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = checklist_templates.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"notifications","policyname":"Secure Access Notifications","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(EXISTS ( SELECT 1\n   FROM tickets t\n  WHERE ((t.id = notifications.ticket_id) AND (((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n           FROM workspaces w\n          WHERE ((w.id = t.workspace_id) AND (w.owner_id = auth.uid()))))) OR (t.workspace_id = ( SELECT current_employee_from_token.workspace_id\n           FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role)))))))","with_check":null},{"schemaname":"public","tablename":"ticket_logs","policyname":"Secure Access Logs","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(EXISTS ( SELECT 1\n   FROM tickets t\n  WHERE ((t.id = ticket_logs.ticket_id) AND (((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n           FROM workspaces w\n          WHERE ((w.id = t.workspace_id) AND (w.owner_id = auth.uid()))))) OR (t.workspace_id = ( SELECT current_employee_from_token.workspace_id\n           FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role)))))))","with_check":null},{"schemaname":"public","tablename":"device_models","policyname":"Secure Access Device Models","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = device_models.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"defect_options","policyname":"Secure Access Defect Options","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = defect_options.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"defects","policyname":"Secure Access Defects","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = defects.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"suppliers","policyname":"Secure Access Suppliers","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = suppliers.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"internal_notes","policyname":"Secure Access Internal Notes","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"ALL","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = internal_notes.workspace_id) AND (w.owner_id = auth.uid()))))) OR (workspace_id = ( SELECT current_employee_from_token.workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role))))","with_check":null},{"schemaname":"public","tablename":"terceirizados","policyname":"Secure Access Terceirizados","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"ALL","qual":"(EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = terceirizados.workspace_id) AND (w.owner_id = auth.uid()))))","with_check":"(EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE ((w.id = terceirizados.workspace_id) AND (w.owner_id = auth.uid()))))"},{"schemaname":"storage","tablename":"objects","policyname":"Secure Storage Select","permissive":"PERMISSIVE","roles":"{anon,authenticated}","cmd":"SELECT","qual":"(((auth.role() = 'authenticated'::text) AND (EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE (((w.id)::text = (storage.foldername(w.name))[1]) AND (w.owner_id = auth.uid()))))) OR (((storage.foldername(name))[1] ~* '^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$'::text) AND ((storage.foldername(name))[1] = ( SELECT (current_employee_from_token.workspace_id)::text AS workspace_id\n   FROM current_employee_from_token() current_employee_from_token(employee_id, workspace_id, role)))))","with_check":null},{"schemaname":"public","tablename":"employees","policyname":"Admin manage employees","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"ALL","qual":"(workspace_id IN ( SELECT workspaces.id\n   FROM workspaces\n  WHERE (workspaces.owner_id = auth.uid())))","with_check":null},{"schemaname":"public","tablename":"workspaces","policyname":"Admins can update own workspace","permissive":"PERMISSIVE","roles":"{public}","cmd":"UPDATE","qual":"(auth.uid() = owner_id)","with_check":"(auth.uid() = owner_id)"},{"schemaname":"public","tablename":"workspaces","policyname":"Admin Update Workspace","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"UPDATE","qual":"(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.workspace_id = workspaces.id) AND (profiles.role = 'admin'::text))))","with_check":"(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.workspace_id = workspaces.id) AND (profiles.role = 'admin'::text))))"},{"schemaname":"public","tablename":"workspaces","policyname":"Admin Select Workspace","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"SELECT","qual":"(EXISTS ( SELECT 1\n   FROM profiles\n  WHERE ((profiles.id = auth.uid()) AND (profiles.workspace_id = workspaces.id))))","with_check":null},{"schemaname":"storage","tablename":"objects","policyname":"Admin Storage Insert","permissive":"PERMISSIVE","roles":"{authenticated}","cmd":"INSERT","qual":null,"with_check":"(EXISTS ( SELECT 1\n   FROM workspaces w\n  WHERE (((w.id)::text = (storage.foldername(w.name))[1]) AND (w.owner_id = auth.uid()))))"}]
